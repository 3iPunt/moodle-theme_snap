define(["core/notification","core/ajax","core/templates","core/str"],function(a,b,c,d){var e=!1;return{ifErrorShowBestMsg:function(f,g,h){if(e)return!0;if("object"!=typeof f)try{var i=JSON.parse(f);f=i}catch(j){}if("undefined"==typeof f&&(f={error:M.util.get_string("unknownerror","core")}),f.error||f.errorcode){if(M.snapTheme.forcePassChange){var k=M.cfg.wwwroot+"/login/change_password.php";if($("#fixy-content").length&&(d.get_string("forcepwdwarningpersonalmenu","theme_snap",k).done(function(a){var b={message:a,extraclasses:"force-pwd-warning"};c.render("core/notification_warning",b).done(function(a){$("#fixy-content").html("<br />"+a)})}),$("#fixy-content").is(":visible")))return;if(window.location.href.indexOf("login/change_password.php")>-1)return;return window.location=k,void(e=!0)}var l=function(b){h?a.alert(null,h,M.util.get_string("ok","moodle")):a.exception(b)};g=g?g:"";var m={failedactionmsg:g};return b.call([{methodname:"theme_snap_loginstatus",args:m,done:function(b){e||(b.loggedin?l(f):($("<style>.confirmation-dialogue .confirmation-buttons input:nth-of-type(2), .moodle-dialogue-base.moodle-dialogue-confirm button.yui3-button.closebutton{ display : none }</style>").appendTo("head"),a.confirm(b.loggedouttitle,b.loggedoutmsg,b.loggedoutcontinue," ",function(){window.location=M.cfg.wwwroot+"/login/index.php"}),e=!0))},fail:function(){l(f)}}],!1,!1),!0}return!1}}});