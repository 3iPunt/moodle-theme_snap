define(["jquery","theme_snap/util","theme_snap/responsive_video","theme_snap/section_asset_management"],function(a,b,c,d){return function(e){var f=this;f.courseConfig=e;var g=function(){return 0===a("body").attr("id").indexOf("page-course-view-")},h=function(c){a("#toc-search-results").html("");var d=a("#"+c.replace("#",""));b.scrollToElement(d);var e=a("#searchpin");e.length||(e=a('<i id="searchpin"></i>')),a(d).find(".instancename").prepend(e),a(d).attr("tabindex","-1").focus()};this.showSection=function(){if(g()){a(".course-content .main, #moodle-blocks,#coursetools, #snap-add-new-section").removeClass("state-visible");var b=location.hash.split("&"),d=b[0],e=b[1]||null;"#coursetools"==d&&a("#moodle-blocks").addClass("state-visible"),null!==e?(a(d).addClass("state-visible"),h(e)):(a(d).addClass("state-visible").focus(),window.scrollTo(0,0));var f=a(".section.main.state-visible,#coursetools.state-visible,#snap-add-new-section.state-visible");f.length||(a("#section-0").addClass("state-visible").focus(),window.scrollTo(0,0)),c.apply();var i=".main.state-visible, #coursetools.state-visible, #snap-add-new-section.state-visible",j=a(i).attr("id");a("#chapters li").removeClass("current"),a('#chapters a[href$="'+j+'"]').parent("li").addClass("current")}};var i=function(){d.init(f),f.courseConfig.enablecompletion&&require(["theme_snap/course_conditionals-lazy"],function(a){a(e)}),g()&&f.showSection()};i()}});