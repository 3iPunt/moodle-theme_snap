define(["jquery","core/ajax","core/notification"],function(a,b,c){var d=function(d){var e=M.theme_snap.courseconfig.unavailablesections.map(Number),f=M.theme_snap.courseconfig.unavailablemods.map(Number);a(document).on("modulecompleted",function(){b.call([{methodname:"theme_snap_course_completion",args:{courseshortname:d,unavailablemods:f.join(",")},done:function(b){var c=function(a,b){var c=a.filter(function(a){return-1==b.indexOf(a)});return c},d=[],g=[];""!==b.unavailablesections&&(d=b.unavailablesections.split(",").map(Number)),g=c(e,d);for(var h in g){var i=g[h];a("#section-"+i+" .content > .snap-restrictions-meta").remove()}if(Object.keys(b.newlyavailablemodhtml).length){var j=b.newlyavailablemodhtml;for(var k in j){var l=j[k];a("#module-"+k).replaceWith(l)}}e=d.map(Number),f=b.unavailablemods.split(",").map(Number)},fail:function(a){c.exception(a)}}],!0,!0)})};return d});